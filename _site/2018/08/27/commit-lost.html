<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

        <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-101783497-1', 'auto');
  ga('send', 'pageview');

</script>


        
        <title>Recovering lost commits</title>
        

        <meta name="description" content="">

        <link rel="icon" href="/assets/img/favicon.png">
        <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono:300,400,500" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Arvo:400,700" rel="stylesheet"> 
        <link href="https://fonts.googleapis.com/css?family=Noto+Serif+KR:500,600,700" rel="stylesheet"> 
        <link rel="stylesheet" type="text/css" href="/assets/css/main.css">
    </head>

    <body>

        <div class="wrapper">
            <div class="post">
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-101783497-1', 'auto');
  ga('send', 'pageview');

</script>

	<a class="post__back" href="/">←</a>
    <h1 class="post__title">Recovering lost commits</h1>
    <p class="post__date">August 27, 2018</p>
    <div class="post__content"?>
        <p>So, you’ve been working on this project of yours, you are on the master branch and at some point in time, for some reason, you decided to go back to a commit. Without even realising, you make some changes and then you do <code class="highlighter-rouge">git checkout master</code>, then you do <code class="highlighter-rouge">git status</code> and finally you realise you’ve messed up big time.</p>

<p>This happened to a friend of mine recently while he was working on a big project, after we started looking for solutions, there were times when it seemed like the changes would have to be done again manually for every file. But git had us covered in a sense that git never loses anything, ofcourse unless you do <code class="highlighter-rouge">git gc</code>, and you can almost always recover your lost stuff.</p>

<h1 id="detached-head">Detached HEAD</h1>
<p>When you checkout a previous commit on a branch, say <code class="highlighter-rouge">master</code>, you are not on any branch, instead you are in a state called <code class="highlighter-rouge">detached HEAD</code>. This is somewhat confusing but it actually makes sense. Think of it this way, going back into history and changing something there may result in a conflict.</p>

<h1 id="dangling-commits">Dangling commits</h1>
<p>The commits you’ve made while in a <code class="highlighter-rouge">detached HEAD</code> state are called dangling commits because they don’t belong to a branch. After you’ve checked out a branch and are no longer in a detached HEAD state, you may think you’ve lost the dangling commit but it is not quite right. Dangling commits can be located in many ways, two of which are:</p>

<ol>
  <li>
    <p><code class="highlighter-rouge">git fsck --lost-found</code>: It identifies all the dangling commits and writes them to the directory <code class="highlighter-rouge">.git/lost-found/commit</code> and to <code class="highlighter-rouge">stdout</code>. It may not be the best way to identify dangling commits since it just shows the commit hash and not the commit message.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">git reflog</code>: It keeps track of all the <code class="highlighter-rouge">refs</code>, which are references to commits, in your local directory. Hence the name <code class="highlighter-rouge">reflog</code>. It is highly unlikely that you won’t find your lost commit here. You can sift through the output to find your lost commit and then copy it’s hash.</p>
  </li>
</ol>

<h1 id="applying-commit">Applying commit</h1>
<p>After copying the commit hash obtained from <code class="highlighter-rouge">git reflog</code>, we can simply do <code class="highlighter-rouge">git merge &lt;hash&gt;</code> to apply the changes to our current branch. But make sure you are on the master branch before doing this otherwise we’re back at square one.
<br />
<br /></p>

<hr />

<h1 id="conclusion">Conclusion</h1>
<p>We can easily recover a lost commit using these steps. Although there might be other cases where this may not be applicable.</p>

<ul>
  <li>Use <code class="highlighter-rouge">git reflog</code> to find the lost commit.</li>
  <li>Copy hash of the lost commit.</li>
  <li>Do <code class="highlighter-rouge">git merge &lt;commit_hash&gt;</code></li>
</ul>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4</pre></td><td class="code"><pre><span class="gp">$ </span>git reflog
<span class="c"># copy lost commit's hash</span>

<span class="gp">$ </span>git merge &lt;<span class="nb">hash</span>&gt;<span class="w">
</span></pre></td></tr></tbody></table></code></pre></figure>

<p>You can repeat this process for a number of commits that you’ve “lost” but make sure you are on the correct branch before actually going ahead and merging the commits.
<br /></p>

<hr />

    </div>
</div>

        </div>

    </body>

</html>
